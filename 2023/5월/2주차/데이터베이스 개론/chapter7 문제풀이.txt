create table 환자(
	환자번호 char(4) not null,
	환자이름 varchar(20) not null,
	나이 int,
	담당의사 char(4)
	primary key(환자번호),
	foreign key(담당의사) references 의사(의사번호)
);

create table 의사(
	의사번호 char(4) not null,
	의사이름 varchar(20),
	소속 varchar(20) default '내과',
	근무연수 int,
	primary key(의사번호),
	constraint ch_근무 check(근무연수>=1 and 근무연수 <=40)
);

select 환자번호, 환자이름 from 환자
where 담당의사 ='d003' and 나이<=40;

select 소속, count(*) as 의사의수, avg(근무연수) as '평균근무연수'
from 의사
group by 소속


1.하위 쿼리 이용해서 하는법
select 의사이름, 소속, 근무연수
from 의사
where 의사번호 = (
				select 담당의사
				from 환자
				where 환자이름 = '김용욱'
				
				);
				
2.조인 이용해서 하는법

select 의사이름, 소속, 근무연수
from 환자, 의사
where 환자.담당의사 = 의사.의사번호 and 환자이름='김용욱'


select 학생.이름, 수강.중간성적
from 학생, 수강
where 학생.학번 = 수강.학번 and 수강.과목번호='A%' and 수강.기말성적>=80
order by 학생.이름 asc,  수강.중간성적 desc;

select 과목이름, count(*) as '학생수' , avg(기말성적) as '성적평균'
from 수강,
group by 과목번호 having count(*)>=3;

select count(*)
from 수강
group by 과목번호 distinct;

select 이름, 학년
from 학생
where 학번 not in (select 학번
		from 수강
		where 과목번호='A003'
		);
		
		
select 이름, 학년
from 학생
where 학번 not exists (select *
		from 수강
		where 과목번호 ='A003');
		

insert into 고객(고객번호, 고객이름, 거주도시, 할인율)
values ('c005', '채희성', '대구', null);

update 주문
set 주문수량 = 주무수량 *1.2
where 고객번호 = (select 고객번호
			from 고객
			where 고객이름='방지호');
			
delete 
from 제품
where 재고량<50;

select distinct 제품명
from 제품
where 가격 in (select min(가격)
			from 제품);
			
select distinct 제품명
from 제품
group by 제품명 having min(가격)

select 고객이름
from 고객
where 고객번호 in (select 고객번호
			from 주문
			whhere 
			
select 고객이름
from 고객, 제품, 주문
where 고객.고객번호 = 주문.주문번호 and 주문.제품번호 = 제품.제품번호
where 제품.제품명 LIKE '%부%';

select 고객번호, count(*) as 주문횟수, sum(주문수량)
from 주문
group by 고객번호 having sum(주문수량)>=300;



select 판매자이름, 수수료, 판매지역
from 판매자
where 수수료 > (select max(수수료)
			from 판매자
			where 판매지역='서울');
			
# 위에랑 같음
비교연산할때 all이랑 any 쓰는것 같다.
all-> 하위쿼리 결과 행 모두와 비교한 결과가 참일때 조건 만족함

select 판매자이름, 수수료, 판매지역
from 판매자
where 수수료 > all (select 수수료
			from 판매자
			where 판매지역='서울');

